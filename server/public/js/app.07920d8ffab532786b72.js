webpackJsonp([1],{"7zck":function(t,e){},FGQs:function(t,e){},HBQ5:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),r=n("Xxa5"),o=n.n(r),i=n("exGp"),s=n.n(i),c=n("Dd8w"),l=n.n(c),u=n("mtWM"),v=n.n(u),d=n("NYxO");n("M4fF");a.a.use(d.a);var m=new d.a.Store({state:{client:{authorized:!1,token:null,name:"",email:"",id:""}},getters:{authorizationStatus:function(t){return t.client.authorized},token:function(t){return t.client.token},currentManager:function(t){return{email:t.client.email,name:t.client.name,id:t.client.id}}},mutations:{authorization:function(t,e){t.client.authorized=e.authorized,t.client.token=e.token,t.client.email=e.email,t.client.name=e.name,t.client.id=e.id},logOut:function(t){t.client.authorized=!1,t.client.token=null,t.client.email=null,t.client.name=null,t.client.id=null}}}),p=function(){return v.a.create({baseURL:"http://localhost:8081/",headers:{"Content-Type":"application/json","x-auth":m.getters.token}})},f=function(t){return p().post("managers/login",t)},h=function(t){return p().post("managers/logout",t)},g=function(){return p().get("/t")},_={data:function(){return{sideNav:!1,menuItems:[{iconTitle:"border_clear",title:"invoices",link:"invoices"},{iconTitle:"people",title:"all users",link:"users"}]}},computed:l()({},Object(d.b)(["currentManager"])),methods:{logOut:function(){var t=this;return s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h({token:t.$store.getters.token});case 3:e.sent,t.$store.commit("logOut"),t.$router.push({path:"/login",params:{logout:!0}}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),alert("Ошибка");case 12:case"end":return e.stop()}},e,t,[[0,8]])}))()}}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-toolbar",{attrs:{color:"primary lighten-1",dark:"",fixed:"",app:""}},[n("v-toolbar-side-icon",{staticClass:"hidden-sm-and-up",nativeOn:{click:function(e){e.stopPropagation(),t.sideNav=!t.sideNav}}}),t._v(" "),n("v-toolbar-title",[n("router-link",{staticStyle:{cursor:"pointer"},attrs:{to:"/",tag:"span"}},[t._v("Trinetix system")])],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-toolbar-items",{staticClass:"hidden-xs-only"},[t._l(t.menuItems,function(e){return n("v-btn",{key:e.title,attrs:{flat:"",router:"",to:e.link}},[n("v-icon",{attrs:{left:""}},[t._v("\n          "+t._s(e.iconTitle)+"\n        ")]),t._v("\n        "+t._s(e.title)+"\n      ")],1)}),t._v(" "),n("v-menu",{attrs:{"offset-y":""}},[n("v-btn",{attrs:{slot:"activator",flat:""},slot:"activator"},[n("v-avatar",{staticClass:"mr-2",attrs:{size:"36px"}},[n("img",{attrs:{src:"https://avatars0.githubusercontent.com/u/9064066?v=4&s=460",alt:"John"}})]),t._v("\n          "+t._s(t.currentManager.name)+"\n        ")],1),t._v(" "),n("v-list",[n("v-list-tile",[n("v-list-tile-title",[n("v-icon",{staticClass:"mr-2",attrs:{left:""}},[t._v("account_circle")]),t._v("Profile info")],1)],1),t._v(" "),n("v-list-tile",{on:{click:t.logOut}},[n("v-list-tile-title",[n("v-icon",{staticClass:"mr-2",attrs:{left:""}},[t._v("keyboard_tab")]),t._v("Log out\n            ")],1)],1)],1)],1)],2)],1)],1)},staticRenderFns:[]},k=n("VU/8")(_,x,!1,null,null,null).exports,w={data:function(){return{email:"",password:"",showProgressLogin:!1}},methods:{submit:function(){var t=this;return s()(o.a.mark(function e(){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.showProgressLogin=!0,e.next=4,f({email:t.email,password:t.password});case 4:n=e.sent,setTimeout(function(){var e={authorized:n.data.session.authorized,id:n.data.session.manager._id,email:n.data.session.manager.email,name:n.data.session.manager.name,token:n.data.token};t.showProgressLogin=!1,t.$store.commit("authorization",e),t.$router.push({path:"/"})},1e3),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t.showProgressLogin=!1,console.log(e.t0);case 12:case"end":return e.stop()}},e,t,[[0,8]])}))()}}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-content",[n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{attrs:{xs12:"",sm8:"",md6:""}},[n("v-card",{staticClass:"elevation-12",staticStyle:{"margin-top":"100px"}},[n("v-toolbar",{attrs:{dark:"",color:"primary lighten-1"}},[n("v-toolbar-title",[t._v("Login form")])],1),t._v(" "),n("v-card-text",[n("v-form",[n("v-text-field",{attrs:{"prepend-icon":"person",name:"login",label:"Login",type:"text"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),t._v(" "),n("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:"Password",id:"password",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary lighten-1"},on:{click:t.submit}},[t.showProgressLogin?n("v-progress-circular",{staticStyle:{"margin-right":"5px"},attrs:{indeterminate:"",color:"white",size:"16"}}):t._e(),t._v(" "),n("span",[t._v("Login")])],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var y=n("VU/8")(w,b,!1,function(t){n("Pi+P")},null,null).exports,z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-footer",{attrs:{height:"auto",color:"primary lighten-1"}},[e("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[e("v-flex",{attrs:{primary:"","lighten-2":"","py-3":"","text-xs-center":"","white--text":"",xs12:""}},[this._v("\n      ©2018 — "),e("strong",[this._v("Trinetix")])])],1)],1)},staticRenderFns:[]},P=n("VU/8")({data:function(){return{}}},z,!1,null,null,null).exports,$={data:function(){return{}},methods:{},computed:l()({},Object(d.b)(["authorizationStatus"])),mounted:function(){},components:{headerComponent:k,loginComponent:y,FooterComponent:P},beforeCreate:function(){var t=this;return s()(o.a.mark(function e(){var n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g();case 3:n=e.sent,console.log(n.data),n.data.manager?(a={authorized:!0,id:n.data.manager._id,email:n.data.manager.email,token:n.data.xAuth},t.$store.commit("authorization",a)):t.$router.push({path:"/login",params:{logout:!0}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-app",[this.authorizationStatus?e("header-component"):this._e(),this._v(" "),e("v-content",[e("v-container",{attrs:{fluid:""}},[e("router-view")],1)],1),this._v(" "),this.authorizationStatus?e("footer-component"):this._e()],1)},staticRenderFns:[]};var L=n("VU/8")($,C,!1,function(t){n("u4Yw")},"data-v-1656eecc",null).exports,S=n("/ocq"),F=n("wUZA");a.a.use(S.a);var O=new S.a({routes:[{path:"/",name:"Home",component:F.default},{path:"/login",name:"Login",component:y,beforeEnter:function(t,e,n){console.log("from",e),n()}}]}),j=n("3EgV"),T=n.n(j);n("7zck");a.a.use(T.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:O,store:m,render:function(t){return t(L)}})},"Pi+P":function(t,e){},u4Yw:function(t,e){},wUZA:function(t,e,n){"use strict";var a=n("FGQs"),r=n.n(a),o=n("xSsj");var i=function(t){n("HBQ5")},s=n("VU/8")(r.a,o.a,!1,i,"data-v-5047c4a6",null);e.default=s.exports},xSsj:function(t,e,n){"use strict";var a={render:function(){var t=this.$createElement;return(this._self._c||t)("h2",[this._v("vsefvsev")])},staticRenderFns:[]};e.a=a}},["NHnr"]);
//# sourceMappingURL=app.07920d8ffab532786b72.js.map